<!DOCTYPE html>
    <html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>News Feed</title>
    <link rel="stylesheet" href="css/subfiles.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="shortcut icon" href="../../../../../img/logo/favicon.ico">
</head>
<body >

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo">
                <div class="logo-icon">W</div>
                <span class="logo-text">Well Testing</span>
            </a>

            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <div class="nav-links" id="navLinks">
                <a href="index.html" class="nav-link">Home</a>
                <a href="ask.html" class="nav-link" id="askNavLink">SWT Community</a>
                <a href="profile.html" class="nav-link" id="profileNavLink" style="display: none;">Profile</a>
                <a href="login.html" class="nav-link btn-outline" id="loginNavLink">Login</a>
                <button class="nav-link btn-danger" id="logoutNavBtn" style="display: none;">Sign Out</button>
            </div>
        </div>
    </nav>

         <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
        <div class="mobile-menu-header">
            <div class="logo-icon">W</div>
            <button class="close-btn" id="closeMobileMenu">√É‚Äî</button>
        </div>

        

        <div class="mobile-menu-content">
            <a href="../index.html" class="mobile-menu-item btn-primary">
                SWT Community
            </a>
            <a href="../../College/OFU.html" class="mobile-menu-item" >
                Learn
            </a>
            <a href="../profile.html" class="mobile-menu-item" id="mobileProfileLink" style="display: none;">
                Profile
            </a>
            <a href="../login.html" class="mobile-menu-item" id="mobileLoginLink">
                Login
            </a>
            <button class="mobile-menu-item text-danger" id="mobileLogoutBtn" style="display: none;">
                Sign Out
            </button>
        </div>
    </div>



    

       
                    <!-- Comment Section -->
            <section class="comment-section" style="width: 80%;" id="answerForm">

            <h2>Share your Thinking ü§îüí≠ </h2>
            <p> </p>

            <form id="commentForm">
                <input 
                type="text" 
                id="username" 
                placeholder="Title " 
                required
                >

                <textarea 
                id="comment" 
                placeholder="Think about  ..." 
                required
                ></textarea>

                <button type="submit">
                Think.. 
                </button>
            </form>

            <div id="commentsContainer"></div>

            </section>

            <div id="answerAuthWarning" style="display: none; text-align: center; padding: 40px; background: var(--bg-card); border-radius: 12px; margin: 60px auto; max-width: 600px;">
                <p style="color: var(--text-muted); font-size: 16px;">Please log in to share your thinking.</p>
                <a href="login.html" style="display: inline-block; margin-top: 15px; padding: 10px 20px; background: var(--accent); color: white; border-radius: 8px; text-decoration: none;">Login</a>
            </div>



           




 

    <!----------------- start Firebase database scripts---------------->
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Custom Scripts -->
    <script src="../js/auth.js"></script>
    <script src="../js/firestore.js"></script>
    <script src="../js/app.js"></script>

    <script>
  const loginLink = document.getElementById("loginNavLink");
  const logoutBtn = document.getElementById("logoutNavBtn");
  const profileLink = document.getElementById("profileNavLink");

  const answerForm = document.getElementById("answerForm");
  const answerWarning = document.getElementById("answerAuthWarning");

  firebase.auth().onAuthStateChanged((user) => {
    if (user) {
      // ‚úÖ Logged in
      if (loginLink) loginLink.style.display = "none";
      if (logoutBtn) logoutBtn.style.display = "inline-block";
      if (profileLink) profileLink.style.display = "inline-block";

      if (answerForm) answerForm.style.display = "block";
      if (answerWarning) answerWarning.style.display = "none";

      console.log("Logged in as:", user.email);
    } else {
      // ‚ùå Not logged in
      if (loginLink) loginLink.style.display = "inline-block";
      if (logoutBtn) logoutBtn.style.display = "none";
      if (profileLink) profileLink.style.display = "none";

      if (answerForm) answerForm.style.display = "none";
      if (answerWarning) answerWarning.style.display = "block";
    }
  });
    </script>

    <script>
  const logoutNavBtn = document.getElementById("logoutNavBtn");
  if (logoutNavBtn) {
    logoutNavBtn.addEventListener("click", async () => {
      await firebase.auth().signOut();
      window.location.href = "login.html";
    });
  }
    </script>

    
    
       <!----------------- start Firebase database scripts---------------->


        <!--firestore verificatio n --><script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import {
    getFirestore,
    collection,
    addDoc,
    onSnapshot,
    query,
    orderBy,
    doc,
    updateDoc,
    increment,
    serverTimestamp
  } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA3d8n_PiXZ7hFXGPFx3tI6Dgasl3DyoBY",
    authDomain: "samygroup-1ee50.firebaseapp.com",
    projectId: "samygroup-1ee50",
    storageBucket: "samygroup-1ee50.firebasestorage.app",
    messagingSenderId: "230412274397",
    appId: "1:230412274397:web:ce031af97a29d6d8b96934"

  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ===== Comments =====
  const form = document.getElementById("commentForm");
  const container = document.getElementById("commentsContainer");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("username").value;
    const comment = document.getElementById("comment").value;

    await addDoc(collection(db, "comments"), {
      name,
      comment,
      likes: 0,
      timestamp: serverTimestamp()
    });

    form.reset();
  });

  function loadComments() {
    const q = query(
      collection(db, "comments"),
      orderBy("timestamp", "desc")
    );

    onSnapshot(q, (snapshot) => {
      container.innerHTML = "";
      snapshot.forEach((docSnap) => {
        const data = docSnap.data();
        container.innerHTML += `
          <div class="comment">
            <strong>${data.name}</strong>
            <p>${data.comment}</p>
            <button onclick="likeComment('${docSnap.id}')">
              ‚ù§Ô∏è ${data.likes || 0}
            </button>
            <hr>
          </div>
        `;
      });
    });
  }

  window.likeComment = async (id) => {
    const ref = doc(db, "comments", id);
    await updateDoc(ref, {
      likes: increment(1)
    });
  };

  loadComments();
</script>


       

    
    </div>

   



</body>
</html>

